<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: DB::Jet
  
    &mdash; Documentation by YARD 0.8.7.3
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (J)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../DB.html" title="DB (module)">DB</a></span></span>
     &raquo; 
    <span class="title">Jet</span>
  

  <div class="noframes"><span class="title">(</span><a href="/doc/." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: DB::Jet
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">ADODbBase</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ADODbBase</li>
          
            <li class="next">DB::Jet</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">app/utils/db/jet.rb</dd>
  
</dl>
<div class="clear"></div>

<div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="../AccessDatabase.html" title="AccessDatabase (class)">AccessDatabase</a></span></p>
</div>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="ACC_DB_REGEXP-constant" class="">ACC_DB_REGEXP =
          
        </dt>
        <dd><pre class="code"><span class='regexp val'>/\.(accdb|mdbx)$/i</span>
</pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-class_method" title="create (class method)">+ (Object) <strong>create</strong>(database_file_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Creates a database with the specified path.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#provider_string-class_method" title="provider_string (class method)">+ (Object) <strong>provider_string</strong>(db_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_fields-instance_method" title="#add_fields (instance method)">- (Object) <strong>add_fields</strong>(table_name, fields_to_add, skip_read = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Adds fields to the specified table.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_many_tables_or_fields-instance_method" title="#add_many_tables_or_fields (instance method)">- (Object) <strong>add_many_tables_or_fields</strong>(tables_and_schemas) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_table-instance_method" title="#add_table (instance method)">- (Object) <strong>add_table</strong>(table_name, field_definitions, skip_reads = false) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Adds the table with specified fields.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_table_or_fields-instance_method" title="#add_table_or_fields (instance method)">- (Object) <strong>add_table_or_fields</strong>(table_name, table_schema) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_table_or_fields_without_defn_update-instance_method" title="#add_table_or_fields_without_defn_update (instance method)">- (Object) <strong>add_table_or_fields_without_defn_update</strong>(table_name, table_schema) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#append_csv-instance_method" title="#append_csv (instance method)">- (Object) <strong>append_csv</strong>(source_directory, source_file, table_name, header_included = true) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Appends a csv file to a specified table.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#close-instance_method" title="#close (instance method)">- (Object) <strong>close</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Closes the database connection.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#drop_table-instance_method" title="#drop_table (instance method)">- (Object) <strong>drop_table</strong>(table_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Drops the specified table.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#execute-instance_method" title="#execute (instance method)">- (Array&lt;Array&gt;, Array&lt;Hash&gt;) <strong>execute</strong>(sql, opts = {}) </a>
    

    
      (also: #run_query, #runQuery)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Returns data as an array (if a select query is executed).</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_field_names-instance_method" title="#get_field_names (instance method)">- (Array&lt;String&gt;) <strong>get_field_names</strong>(table_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Returns a list of field names for the specified table.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_field_types-instance_method" title="#get_field_types (instance method)">- (Array&lt;String&gt;) <strong>get_field_types</strong>(table_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Returns a list of field types for the specified table (as ADO type codes).</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_new_fields-instance_method" title="#get_new_fields (instance method)">- (Object) <strong>get_new_fields</strong>(table_name, fields_to_add) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_table_names-instance_method" title="#get_table_names (instance method)">- (Array&lt;String&gt;) <strong>get_table_names</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Returns a list of tables in the database.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Jet) <strong>initialize</strong>(dbPath, schema = nil) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>A new instance of Jet.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#insert-instance_method" title="#insert (instance method)">- (Object) <strong>insert</strong>(table_name, data, field_names) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Appends data to a specified table.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rename_field-instance_method" title="#rename_field (instance method)">- (Object) <strong>rename_field</strong>(table_name, current_field_name, new_field_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Renames a field within the specified table.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reopen_connection-instance_method" title="#reopen_connection (instance method)">- (Object) <strong>reopen_connection</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Reopens the connection.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#table_exists%3F-instance_method" title="#table_exists? (instance method)">- (Bool) <strong>table_exists?</strong>(table_name) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>Returns True / false, depending on whether the table exists.</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_database-instance_method" title="#update_database (instance method)">- (Object) <strong>update_database</strong>(schema) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="/doc/" title="DB::Jet (class)">Jet</a></span></tt>) <strong>initialize</strong>(dbPath, schema = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Returns a new instance of Jet

  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7
8
9
10
11</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 5</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rubyid_dbPath identifier id'>dbPath</span><span class='comma token'>,</span> <span class='rubyid_schema identifier id'>schema</span> <span class='assign token'>=</span> <span class='rubyid_nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='dstring node'>&quot;Specified DB [#{dbPath}] does not exist&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='notop op'>!</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_dbPath identifier id'>dbPath</span><span class='rparen token'>)</span>
  <span class='rubyid_@path ivar id'>@path</span> <span class='assign token'>=</span> <span class='rubyid_dbPath identifier id'>dbPath</span>
  <span class='comment val'># our ADO connection</span>
  <span class='rubyid_open_connection identifier id'>open_connection</span>
  <span class='rubyid_update_database identifier id'>update_database</span><span class='lparen token'>(</span><span class='rubyid_schema identifier id'>schema</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_schema identifier id'>schema</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create-class_method">
  
    + (<tt>Object</tt>) <strong>create</strong>(database_file_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Creates a database with the specified path.  Raises if the file already exists.

  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 19</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_create identifier id'>create</span><span class='lparen token'>(</span><span class='rubyid_database_file_name identifier id'>database_file_name</span><span class='rparen token'>)</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='dstring node'>&quot;File already exists: #{database_file_name}&quot;</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_database_file_name identifier id'>database_file_name</span><span class='rparen token'>)</span>
  <span class='rubyid_FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='rubyid_mkdir_p identifier id'>mkdir_p</span><span class='lparen token'>(</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='rubyid_database_file_name identifier id'>database_file_name</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

  <span class='comment val'># Hack for 97 - if there's a ShellNew template, use that to create the database</span>
  <span class='rubyid_shellnew_template identifier id'>shellnew_template</span> <span class='assign token'>=</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='rubyid_ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>&quot;SystemRoot&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='string val'>&quot;ShellNew&quot;</span><span class='comma token'>,</span><span class='string val'>&quot;MSAccess.mdb&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_shellnew_template identifier id'>shellnew_template</span><span class='rparen token'>)</span> <span class='rubyid_then then kw'>then</span>
    <span class='rubyid_cp identifier id'>cp</span> <span class='rubyid_shellnew_template identifier id'>shellnew_template</span><span class='comma token'>,</span> <span class='rubyid_database_file_name identifier id'>database_file_name</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_cat identifier id'>cat</span> <span class='assign token'>=</span> <span class='rubyid_WIN32OLE constant id'>WIN32OLE</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'ADOX.Catalog'</span><span class='rparen token'>)</span>
    <span class='rubyid_cat identifier id'>cat</span><span class='dot token'>.</span><span class='rubyid_Create constant id'>Create</span> <span class='dstring node'>&quot;Provider=#{Jet.provider_string(database_file_name)} Data Source=#{database_file_name}&quot;</span>
  <span class='rubyid_end end kw'>end</span>

  <span class='rubyid_return return kw'>return</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_database_file_name identifier id'>database_file_name</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="provider_string-class_method">
  
    + (<tt>Object</tt>) <strong>provider_string</strong>(db_name) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


240
241
242</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 240</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_provider_string identifier id'>provider_string</span><span class='lparen token'>(</span><span class='rubyid_db_name identifier id'>db_name</span><span class='rparen token'>)</span>
  <span class='rubyid_db_name identifier id'>db_name</span><span class='dot token'>.</span><span class='rubyid_match identifier id'>match</span><span class='lparen token'>(</span><span class='rubyid_ACC_DB_REGEXP constant id'>ACC_DB_REGEXP</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='string val'>'Microsoft.ACE.OLEDB.12.0;'</span> <span class='colon op'>:</span> <span class='string val'>'Microsoft.Jet.OLEDB.4.0;'</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_fields-instance_method">
  
    - (<tt>Object</tt>) <strong>add_fields</strong>(table_name, fields_to_add, skip_read = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Adds fields to the specified table

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='rubyid_new_fields identifier id'>new_fields</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='string val'>'new_field'</span><span class='comma token'>,</span> <span class='string val'>'SHORT'</span><span class='comma token'>,</span> <span class='string val'>'VALUE'</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
<span class='rubyid_access_database identifier id'>access_database</span><span class='dot token'>.</span><span class='rubyid_add_fields identifier id'>add_fields</span><span class='lparen token'>(</span><span class='string val'>'my_table'</span><span class='comma token'>,</span> <span class='rubyid_new_fields identifier id'>new_fields</span><span class='rparen token'>)</span>
</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>table_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The name of the table</div>
      
    </li>
  
    <li>
      
        <span class='name'>fields_to_add</span>
      
      
        <span class='type'>(<tt>Array&lt;Array&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>An array of fields, where each field is a sub-array of length 3 ['field_name', 'SHORT', 'VALUE']</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


178
179
180
181
182
183
184</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 178</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_add_fields identifier id'>add_fields</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_fields_to_add identifier id'>fields_to_add</span><span class='comma token'>,</span> <span class='rubyid_skip_read identifier id'>skip_read</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
  <span class='rubyid_get_new_fields identifier id'>get_new_fields</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_fields_to_add identifier id'>fields_to_add</span><span class='dot token'>.</span><span class='rubyid_box identifier id'>box</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='lparen token'>(</span><span class='rubyid_field_name identifier id'>field_name</span><span class='comma token'>,</span> <span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_key identifier id'>key</span><span class='rparen token'>)</span><span class='bitor op'>|</span>
    <span class='rubyid_@conn ivar id'>@conn</span><span class='dot token'>.</span><span class='rubyid_execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;ALTER TABLE [#{table_name}] ADD COLUMN [#{field_name}] #{type}&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_Logger constant id'>Logger</span><span class='dot token'>.</span><span class='rubyid_warn identifier id'>warn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;We are unable to add new primary keys at the moment. Field #{field_name} not added&quot;</span><span class='rparen token'>)</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_key identifier id'>key</span><span class='dot token'>.</span><span class='rubyid_to_sym identifier id'>to_sym</span> <span class='eq op'>==</span> <span class='symbol val'>:PRIMARY_KEY</span>
  <span class='rbrace token'>}</span>
  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span> <span class='assign token'>=</span> <span class='rubyid_read_table_definitions identifier id'>read_table_definitions</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_skip_read identifier id'>skip_read</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_many_tables_or_fields-instance_method">
  
    - (<tt>Object</tt>) <strong>add_many_tables_or_fields</strong>(tables_and_schemas) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


227
228
229
230
231
232</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 227</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_add_many_tables_or_fields identifier id'>add_many_tables_or_fields</span><span class='lparen token'>(</span><span class='rubyid_tables_and_schemas identifier id'>tables_and_schemas</span><span class='rparen token'>)</span>
  <span class='rubyid_tables_and_schemas identifier id'>tables_and_schemas</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_table_schema identifier id'>table_schema</span><span class='rparen token'>)</span><span class='bitor op'>|</span>
    <span class='rubyid_add_table_or_fields_without_defn_update identifier id'>add_table_or_fields_without_defn_update</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_table_schema identifier id'>table_schema</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span> <span class='assign token'>=</span> <span class='rubyid_read_table_definitions identifier id'>read_table_definitions</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_table-instance_method">
  
    - (<tt>Object</tt>) <strong>add_table</strong>(table_name, field_definitions, skip_reads = false) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Adds the table with specified fields

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='rubyid_fields identifier id'>fields</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='string val'>'field1'</span><span class='comma token'>,</span> <span class='string val'>'SHORT'</span><span class='comma token'>,</span> <span class='string val'>'PRIMARY KEY'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>'field2'</span><span class='comma token'>,</span> <span class='string val'>'INTEGER'</span><span class='comma token'>,</span> <span class='string val'>'VALUE'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>'field3'</span><span class='comma token'>,</span> <span class='string val'>'CHAR(20)'</span><span class='comma token'>,</span> <span class='string val'>'VALUE'</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
<span class='rubyid_access_database identifier id'>access_database</span><span class='dot token'>.</span><span class='rubyid_add_table identifier id'>add_table</span><span class='lparen token'>(</span><span class='string val'>'my_table'</span><span class='comma token'>,</span> <span class='rubyid_fields identifier id'>fields</span><span class='rparen token'>)</span>
</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>table_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The name of the table</div>
      
    </li>
  
    <li>
      
        <span class='name'>field_definitions</span>
      
      
        <span class='type'>(<tt>Array&lt;Array&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>List of fields, where each field is a sub-array. eg. ['field_name', 'SHORT', 'VALUE']</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


110
111
112
113
114
115
116
117
118
119</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 110</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_add_table identifier id'>add_table</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_field_definitions identifier id'>field_definitions</span><span class='comma token'>,</span> <span class='rubyid_skip_reads identifier id'>skip_reads</span> <span class='assign token'>=</span> <span class='rubyid_false false kw'>false</span><span class='rparen token'>)</span>
  <span class='rubyid_field_str identifier id'>field_str</span>       <span class='assign token'>=</span> <span class='dstring node'>&quot;#{field_definitions.map { |(field, type, key)| &quot;[#{field}] #{type}&quot; }.join(',')}&quot;</span>
  <span class='rubyid_primary_key_str identifier id'>primary_key_str</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{field_definitions.select { |(field, type, key)| key.to_sym == :PRIMARY_KEY }.map { |(fieldname, type, key)| fieldname.to_s }.join(',')}&quot;</span>

  <span class='rubyid_constraint identifier id'>constraint</span> <span class='assign token'>=</span> <span class='rubyid_primary_key_str identifier id'>primary_key_str</span><span class='dot token'>.</span><span class='rubyid_size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='question op'>?</span> <span class='string val'>''</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;, CONSTRAINT pk PRIMARY KEY (#{primary_key_str})&quot;</span>
  <span class='rubyid_sql identifier id'>sql</span>        <span class='assign token'>=</span> <span class='dstring node'>&quot;CREATE TABLE [#{table_name}] (#{field_str}#{constraint})&quot;</span>
  <span class='rubyid_Logger constant id'>Logger</span><span class='dot token'>.</span><span class='rubyid_log identifier id'>log</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Execute: #{sql}&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_execute identifier id'>execute</span><span class='lparen token'>(</span><span class='rubyid_sql identifier id'>sql</span><span class='rparen token'>)</span>
  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span> <span class='assign token'>=</span> <span class='rubyid_read_table_definitions identifier id'>read_table_definitions</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_skip_reads identifier id'>skip_reads</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_table_or_fields-instance_method">
  
    - (<tt>Object</tt>) <strong>add_table_or_fields</strong>(table_name, table_schema) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


214
215
216
217</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 214</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_add_table_or_fields identifier id'>add_table_or_fields</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_table_schema identifier id'>table_schema</span><span class='rparen token'>)</span>
  <span class='rubyid_add_table_or_fields_without_defn_update identifier id'>add_table_or_fields_without_defn_update</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_table_schema identifier id'>table_schema</span><span class='rparen token'>)</span>
  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span> <span class='assign token'>=</span> <span class='rubyid_read_table_definitions identifier id'>read_table_definitions</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_table_or_fields_without_defn_update-instance_method">
  
    - (<tt>Object</tt>) <strong>add_table_or_fields_without_defn_update</strong>(table_name, table_schema) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


219
220
221
222
223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 219</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_add_table_or_fields_without_defn_update identifier id'>add_table_or_fields_without_defn_update</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_table_schema identifier id'>table_schema</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_table_exists? fid id'>table_exists?</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span>
    <span class='rubyid_add_fields identifier id'>add_fields</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_table_schema identifier id'>table_schema</span><span class='comma token'>,</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_add_table identifier id'>add_table</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_table_schema identifier id'>table_schema</span><span class='comma token'>,</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="append_csv-instance_method">
  
    - (<tt>Object</tt>) <strong>append_csv</strong>(source_directory, source_file, table_name, header_included = true) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Appends a csv file to a specified table

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>source_directory</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The directory containing the csv file</div>
      
    </li>
  
    <li>
      
        <span class='name'>source_file</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The name of the csv file</div>
      
    </li>
  
    <li>
      
        <span class='name'>table_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The name of the table to import into (must already exist)</div>
      
    </li>
  
    <li>
      
        <span class='name'>header_included</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>Defines whether the csv includes a header</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


196
197
198
199</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 196</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_append_csv identifier id'>append_csv</span><span class='lparen token'>(</span><span class='rubyid_source_directory identifier id'>source_directory</span><span class='comma token'>,</span> <span class='rubyid_source_file identifier id'>source_file</span><span class='comma token'>,</span> <span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_header_included identifier id'>header_included</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span><span class='rparen token'>)</span>
  <span class='rubyid_header identifier id'>header</span> <span class='assign token'>=</span> <span class='rubyid_header_included identifier id'>header_included</span> <span class='integer val'>? </span><span class='string val'>&quot;True&quot;</span> <span class='colon op'>:</span> <span class='string val'>&quot;False&quot;</span>
  <span class='rubyid_@conn ivar id'>@conn</span><span class='dot token'>.</span><span class='rubyid_execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;INSERT INTO [#{table_name}] SELECT * FROM [Text;ColNameHeader=#{header};DATABASE=#{source_directory}].[#{source_file}]&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="close-instance_method">
  
    - (<tt>Object</tt>) <strong>close</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Closes the database connection

  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


235
236
237</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 235</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_close identifier id'>close</span>
  <span class='rubyid_@conn ivar id'>@conn</span><span class='dot token'>.</span><span class='rubyid_close identifier id'>close</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="drop_table-instance_method">
  
    - (<tt>Object</tt>) <strong>drop_table</strong>(table_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Drops the specified table

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='comment val'># delete a table</span>
<span class='rubyid_access_database identifier id'>access_database</span><span class='dot token'>.</span><span class='rubyid_drop_table identifier id'>drop_table</span><span class='lparen token'>(</span><span class='string val'>'my_table'</span><span class='rparen token'>)</span>
</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>table_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The name of the table</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98
99
100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 95</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_drop_table identifier id'>drop_table</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_table_exists? fid id'>table_exists?</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span>
    <span class='rubyid_@conn ivar id'>@conn</span><span class='dot token'>.</span><span class='rubyid_execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;DROP TABLE [#{table_name}]&quot;</span><span class='rparen token'>)</span>
    <span class='rubyid_Logger constant id'>Logger</span><span class='dot token'>.</span><span class='rubyid_log identifier id'>log</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Dropped #{table_name}&quot;</span><span class='rparen token'>)</span>
    <span class='comment val'># TODO: Don't re-read everything, just delete this table</span>
    <span class='rubyid_@table_definitions ivar id'>@table_definitions</span> <span class='assign token'>=</span> <span class='rubyid_read_table_definitions identifier id'>read_table_definitions</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="execute-instance_method">
  
    - (<tt>Array&lt;Array&gt;</tt>, <tt>Array&lt;Hash&gt;</tt>) <strong>execute</strong>(sql, opts = {}) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='run_query-instance_method'>run_query</span>, <span id='runQuery-instance_method'>runQuery</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    Returns data as an array (if a select query is executed)

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='comment val'># select query</span>
<span class='rubyid_records identifier id'>records</span> <span class='assign token'>=</span> <span class='rubyid_access_database identifier id'>access_database</span><span class='dot token'>.</span><span class='rubyid_execute identifier id'>execute</span><span class='lparen token'>(</span><span class='string val'>&quot;SELECT field1, field2 FROM [my_table] WHERE field3 = 10&quot;</span><span class='rparen token'>)</span>
<span class='rubyid_records identifier id'>records</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_field1 identifier id'>field1</span><span class='comma token'>,</span><span class='rubyid_field2 identifier id'>field2</span><span class='bitor op'>|</span> <span class='comment val'># do something }</span>
</code></pre>
    
      
      <pre class="example code"><code><span class='comment val'># delete query</span>
<span class='rubyid_access_database identifier id'>access_database</span><span class='dot token'>.</span><span class='rubyid_execute identifier id'>execute</span><span class='lparen token'>(</span><span class='string val'>&quot;DELETE FROM [my_table] WHERE field1 = 10&quot;</span><span class='rparen token'>)</span>
</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>sql</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The sql to be executed</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>Options hash.  Options are: :as_hash (if true, records are returned as hashes, with field name symbols as keys)</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Array&gt;</tt>, <tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>Returns data as an array (if a select query is executed)</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 59</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_execute identifier id'>execute</span><span class='lparen token'>(</span><span class='rubyid_sql identifier id'>sql</span><span class='comma token'>,</span> <span class='rubyid_opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='rubyid_opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:keys_as_symbols</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='rubyid_true true kw'>true</span>
  <span class='rubyid_record_set identifier id'>record_set</span> <span class='assign token'>=</span> <span class='rubyid_WIN32OLE constant id'>WIN32OLE</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'ADODB.recordset'</span><span class='rparen token'>)</span>
  <span class='rubyid_record_set identifier id'>record_set</span><span class='dot token'>.</span><span class='rubyid_CursorType constant id'>CursorType</span> <span class='assign token'>=</span> <span class='integer val'>3</span>
  <span class='rubyid_record_set identifier id'>record_set</span><span class='dot token'>.</span><span class='rubyid_Open constant id'>Open</span><span class='lparen token'>(</span><span class='rubyid_sql identifier id'>sql</span><span class='comma token'>,</span> <span class='rubyid_@conn ivar id'>@conn</span><span class='rparen token'>)</span>

  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span> <span class='assign token'>=</span> <span class='rubyid_read_table_definitions identifier id'>read_table_definitions</span> <span class='rubyid_if if_mod kw'>if</span> <span class='rubyid_sql identifier id'>sql</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span> <span class='match op'>=~</span> <span class='regexp val'>/create|alter|drop/</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_sql identifier id'>sql</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span> <span class='match op'>=~</span> <span class='regexp val'>/select/</span>

  <span class='rubyid_record_set_wrapper identifier id'>record_set_wrapper</span> <span class='assign token'>=</span> <span class='rubyid_RecordSetWrapper constant id'>RecordSetWrapper</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='rubyid_record_set identifier id'>record_set</span><span class='rparen token'>)</span>
  
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_block_given? fid id'>block_given?</span> <span class='rubyid_then then kw'>then</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:as_hash</span><span class='rbrack token'>]</span> <span class='rubyid_then then kw'>then</span>
      <span class='rubyid_record_set_wrapper identifier id'>record_set_wrapper</span><span class='dot token'>.</span><span class='rubyid_each_as_hash identifier id'>each_as_hash</span><span class='lparen token'>(</span><span class='rubyid_opts identifier id'>opts</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_row identifier id'>row</span><span class='bitor op'>|</span> <span class='rubyid_yield yield kw'>yield</span> <span class='rubyid_row identifier id'>row</span> <span class='rbrace token'>}</span>
    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_record_set_wrapper identifier id'>record_set_wrapper</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_row identifier id'>row</span><span class='bitor op'>|</span> <span class='rubyid_yield yield kw'>yield</span> <span class='rubyid_row identifier id'>row</span> <span class='rbrace token'>}</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:as_hash</span><span class='rbrack token'>]</span> <span class='rubyid_then then kw'>then</span>
      <span class='rubyid_array identifier id'>array</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
      <span class='rubyid_record_set_wrapper identifier id'>record_set_wrapper</span><span class='dot token'>.</span><span class='rubyid_each_as_hash identifier id'>each_as_hash</span><span class='lparen token'>(</span><span class='rubyid_opts identifier id'>opts</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_row identifier id'>row</span><span class='bitor op'>|</span> <span class='rubyid_array identifier id'>array</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_row identifier id'>row</span> <span class='rbrace token'>}</span>
      <span class='rubyid_return return kw'>return</span> <span class='rubyid_array identifier id'>array</span>
    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_return return kw'>return</span> <span class='rubyid_record_set_wrapper identifier id'>record_set_wrapper</span><span class='dot token'>.</span><span class='rubyid_to_a identifier id'>to_a</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_rescue rescue kw'>rescue</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_e identifier id'>e</span>
  <span class='rubyid_Logger constant id'>Logger</span><span class='dot token'>.</span><span class='rubyid_warn identifier id'>warn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Error executing #{sql}&quot;</span><span class='rparen token'>)</span>
  <span class='rubyid_raise identifier id'>raise</span> <span class='rubyid_e identifier id'>e</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_field_names-instance_method">
  
    - (<tt>Array&lt;String&gt;</tt>) <strong>get_field_names</strong>(table_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Returns a list of field names for the specified table

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>table_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The name of the table</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>Returns a list of field names for the specified table</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 136</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_get_field_names identifier id'>get_field_names</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span>
  <span class='rubyid_return return kw'>return</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='rubyid_if if_mod kw'>if</span> <span class='notop op'>!</span><span class='rubyid_table_exists? fid id'>table_exists?</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span>
  <span class='rubyid_name identifier id'>name</span> <span class='assign token'>=</span> <span class='rubyid_@table_definitions ivar id'>@table_definitions</span><span class='dot token'>.</span><span class='rubyid_keys identifier id'>keys</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_e identifier id'>e</span><span class='bitor op'>|</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='rubyid_table_name identifier id'>table_name</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_@table_definitions ivar id'>@table_definitions</span><span class='lbrack token'>[</span><span class='rubyid_name identifier id'>name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:fieldnames</span><span class='rbrack token'>]</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_field_types-instance_method">
  
    - (<tt>Array&lt;String&gt;</tt>) <strong>get_field_types</strong>(table_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Returns a list of field types for the specified table (as ADO type codes)

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>table_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The name of the table</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>Returns a list of field types for the specified table (as ADO type codes)</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146
147
148</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 144</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_get_field_types identifier id'>get_field_types</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span>
  <span class='rubyid_return return kw'>return</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='rubyid_if if_mod kw'>if</span> <span class='notop op'>!</span><span class='rubyid_table_exists? fid id'>table_exists?</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span>
  <span class='rubyid_name identifier id'>name</span> <span class='assign token'>=</span> <span class='rubyid_@table_definitions ivar id'>@table_definitions</span><span class='dot token'>.</span><span class='rubyid_keys identifier id'>keys</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_e identifier id'>e</span><span class='bitor op'>|</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='rubyid_table_name identifier id'>table_name</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_first identifier id'>first</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_@table_definitions ivar id'>@table_definitions</span><span class='lbrack token'>[</span><span class='rubyid_name identifier id'>name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:fieldtypes</span><span class='rbrack token'>]</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_new_fields-instance_method">
  
    - (<tt>Object</tt>) <strong>get_new_fields</strong>(table_name, fields_to_add) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


186
187
188
189</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 186</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_get_new_fields identifier id'>get_new_fields</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_fields_to_add identifier id'>fields_to_add</span><span class='rparen token'>)</span>
  <span class='rubyid_lower_case_fields_to_add identifier id'>lower_case_fields_to_add</span> <span class='assign token'>=</span> <span class='rubyid_fields_to_add identifier id'>fields_to_add</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='symbol val'>:first</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='symbol val'>:downcase</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='rubyid_self self kw'>self</span><span class='dot token'>.</span><span class='rubyid_get_field_names identifier id'>get_field_names</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='symbol val'>:downcase</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='symbol val'>:to_sym</span><span class='rparen token'>)</span>
  <span class='rubyid_return return kw'>return</span> <span class='rubyid_fields_to_add identifier id'>fields_to_add</span><span class='dot token'>.</span><span class='rubyid_select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='lparen token'>(</span><span class='rubyid_fieldname identifier id'>fieldname</span><span class='comma token'>,</span> <span class='rubyid_type identifier id'>type</span><span class='comma token'>,</span> <span class='rubyid_key identifier id'>key</span><span class='rparen token'>)</span><span class='bitor op'>|</span> <span class='rubyid_lower_case_fields_to_add identifier id'>lower_case_fields_to_add</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_fieldname identifier id'>fieldname</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_table_names-instance_method">
  
    - (<tt>Array&lt;String&gt;</tt>) <strong>get_table_names</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Returns a list of tables in the database

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>Returns a list of tables in the database</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124
125</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 122</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_get_table_names identifier id'>get_table_names</span>
  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span> <span class='opasgn op'>||=</span> <span class='rubyid_read_table_definitions identifier id'>read_table_definitions</span>
  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span><span class='dot token'>.</span><span class='rubyid_keys identifier id'>keys</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="insert-instance_method">
  
    - (<tt>Object</tt>) <strong>insert</strong>(table_name, data, field_names) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Appends data to a specified table

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='rubyid_data identifier id'>data</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='integer val'>3</span><span class='comma token'>,</span><span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
<span class='rubyid_access_database identifier id'>access_database</span><span class='dot token'>.</span><span class='rubyid_insert identifier id'>insert</span><span class='lparen token'>(</span><span class='string val'>'my_table'</span><span class='comma token'>,</span> <span class='rubyid_data identifier id'>data</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>'field1'</span><span class='comma token'>,</span> <span class='string val'>'field2'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>table_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The table to which the data is to be appended</div>
      
    </li>
  
    <li>
      
        <span class='name'>data</span>
      
      
        <span class='type'>(<tt>Array&lt;Array&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The data to be appended</div>
      
    </li>
  
    <li>
      
        <span class='name'>field_names</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The fields to be populated</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


208
209
210
211
212</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 208</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_insert identifier id'>insert</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_data identifier id'>data</span><span class='comma token'>,</span> <span class='rubyid_field_names identifier id'>field_names</span><span class='rparen token'>)</span>
  <span class='rubyid_data identifier id'>data</span><span class='dot token'>.</span><span class='rubyid_write_to_csv identifier id'>write_to_csv</span><span class='lparen token'>(</span><span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_tmpdir identifier id'>tmpdir</span> <span class='div op'>/</span> <span class='string val'>'temp.csv'</span><span class='comma token'>,</span> <span class='rubyid_field_names identifier id'>field_names</span><span class='dot token'>.</span><span class='rubyid_join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='rubyid_append_csv identifier id'>append_csv</span><span class='lparen token'>(</span><span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_tmpdir identifier id'>tmpdir</span><span class='comma token'>,</span><span class='string val'>'temp.csv'</span><span class='comma token'>,</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span>
  <span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_delete identifier id'>delete</span><span class='lparen token'>(</span><span class='rubyid_Dir constant id'>Dir</span><span class='dot token'>.</span><span class='rubyid_tmpdir identifier id'>tmpdir</span> <span class='div op'>/</span> <span class='string val'>'temp.csv'</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rename_field-instance_method">
  
    - (<tt>Object</tt>) <strong>rename_field</strong>(table_name, current_field_name, new_field_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Renames a field within the specified table

  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='rubyid_access_database identifier id'>access_database</span><span class='dot token'>.</span><span class='rubyid_rename_field identifier id'>rename_field</span><span class='lparen token'>(</span><span class='string val'>'my_table'</span><span class='comma token'>,</span> <span class='string val'>'old_field_name'</span><span class='comma token'>,</span> <span class='string val'>'new_field_name'</span><span class='rparen token'>)</span>
</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>table_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The name of the table</div>
      
    </li>
  
    <li>
      
        <span class='name'>current_field_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The current name of the field</div>
      
    </li>
  
    <li>
      
        <span class='name'>new_field_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The new name of the field</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 156</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_rename_field identifier id'>rename_field</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='rubyid_current_field_name identifier id'>current_field_name</span><span class='comma token'>,</span> <span class='rubyid_new_field_name identifier id'>new_field_name</span><span class='rparen token'>)</span>
  <span class='rubyid_cat identifier id'>cat</span> <span class='assign token'>=</span> <span class='rubyid_WIN32OLE constant id'>WIN32OLE</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'ADOX.Catalog'</span><span class='rparen token'>)</span>
  <span class='rubyid_cat identifier id'>cat</span><span class='dot token'>.</span><span class='rubyid_ActiveConnection constant id'>ActiveConnection</span> <span class='assign token'>=</span> <span class='rubyid_@conn ivar id'>@conn</span>
  <span class='integer val'>0</span><span class='dot token'>.</span><span class='rubyid_upto identifier id'>upto</span><span class='lparen token'>(</span><span class='rubyid_cat identifier id'>cat</span><span class='dot token'>.</span><span class='rubyid_Tables constant id'>Tables</span><span class='dot token'>.</span><span class='rubyid_Count constant id'>Count</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_t identifier id'>t</span><span class='bitor op'>|</span>
    <span class='rubyid_table identifier id'>table</span> <span class='assign token'>=</span> <span class='rubyid_cat identifier id'>cat</span><span class='dot token'>.</span><span class='rubyid_Tables constant id'>Tables</span><span class='lparen token'>(</span><span class='rubyid_t identifier id'>t</span><span class='rparen token'>)</span>
    <span class='rubyid_next next kw'>next</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_table identifier id'>table</span><span class='dot token'>.</span><span class='rubyid_Name constant id'>Name</span> <span class='match op'>=~</span> <span class='dregexp node'>/^#{table_name}$/</span>
    <span class='rubyid_puts identifier id'>puts</span> <span class='string val'>&quot;found the table in the catalog&quot;</span>
    <span class='integer val'>0</span><span class='dot token'>.</span><span class='rubyid_upto identifier id'>upto</span><span class='lparen token'>(</span><span class='rubyid_cat identifier id'>cat</span><span class='dot token'>.</span><span class='rubyid_Tables constant id'>Tables</span><span class='lparen token'>(</span><span class='rubyid_t identifier id'>t</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_Columns constant id'>Columns</span><span class='dot token'>.</span><span class='rubyid_count identifier id'>count</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span>
      <span class='rubyid_col identifier id'>col</span> <span class='assign token'>=</span> <span class='rubyid_cat identifier id'>cat</span><span class='dot token'>.</span><span class='rubyid_Tables constant id'>Tables</span><span class='lparen token'>(</span><span class='rubyid_t identifier id'>t</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='rubyid_Columns constant id'>Columns</span><span class='lparen token'>(</span><span class='rubyid_c identifier id'>c</span><span class='rparen token'>)</span>
      <span class='rubyid_next next kw'>next</span> <span class='rubyid_unless unless_mod kw'>unless</span> <span class='rubyid_col identifier id'>col</span><span class='dot token'>.</span><span class='rubyid_Name constant id'>Name</span> <span class='match op'>=~</span> <span class='dregexp node'>/^#{current_field_name}$/</span>
      <span class='rubyid_col identifier id'>col</span><span class='dot token'>.</span><span class='rubyid_Name constant id'>Name</span> <span class='assign token'>=</span> <span class='rubyid_new_field_name identifier id'>new_field_name</span>
    <span class='rbrace token'>}</span>
  <span class='rbrace token'>}</span>
  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span> <span class='assign token'>=</span> <span class='rubyid_read_table_definitions identifier id'>read_table_definitions</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reopen_connection-instance_method">
  
    - (<tt>Object</tt>) <strong>reopen_connection</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Reopens the connection. Useful if the database an object becomes locked.

  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


14
15
16</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 14</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_reopen_connection identifier id'>reopen_connection</span>
  <span class='rubyid_open_connection identifier id'>open_connection</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="table_exists?-instance_method">
  
    - (<tt>Bool</tt>) <strong>table_exists?</strong>(table_name) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    Returns True / false, depending on whether the table exists

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>table_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>The name of the table</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>Returns True / false, depending on whether the table exists</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


129
130
131
132</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 129</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_table_exists? fid id'>table_exists?</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='rparen token'>)</span>
  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span> <span class='opasgn op'>||=</span> <span class='rubyid_read_table_definitions identifier id'>read_table_definitions</span>
  <span class='rubyid_@table_definitions ivar id'>@table_definitions</span><span class='dot token'>.</span><span class='rubyid_keys identifier id'>keys</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_e identifier id'>e</span><span class='bitor op'>|</span> <span class='rubyid_e identifier id'>e</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='rubyid_include? fid id'>include?</span><span class='lparen token'>(</span><span class='rubyid_table_name identifier id'>table_name</span><span class='dot token'>.</span><span class='rubyid_downcase identifier id'>downcase</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_database-instance_method">
  
    - (<tt>Object</tt>) <strong>update_database</strong>(schema) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37
38
39
40
41
42
43
44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/utils/db/jet.rb', line 35</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_update_database identifier id'>update_database</span><span class='lparen token'>(</span><span class='rubyid_schema identifier id'>schema</span><span class='rparen token'>)</span>
  <span class='rubyid_schema identifier id'>schema</span><span class='dot token'>.</span><span class='rubyid_each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='rubyid_description identifier id'>description</span><span class='comma token'>,</span> <span class='rubyid_h1 identifier id'>h1</span><span class='bitor op'>|</span>
    <span class='rubyid_tbl_name identifier id'>tbl_name</span><span class='comma token'>,</span> <span class='rubyid_tbl_schema identifier id'>tbl_schema</span> <span class='assign token'>=</span> <span class='rubyid_h1 identifier id'>h1</span><span class='lbrack token'>[</span><span class='symbol val'>:tbl_name</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rubyid_h1 identifier id'>h1</span><span class='lbrack token'>[</span><span class='symbol val'>:tbl_schema</span><span class='rbrack token'>]</span>

    <span class='rubyid_if if kw'>if</span> <span class='notop op'>!</span><span class='rubyid_table_exists? fid id'>table_exists?</span><span class='lparen token'>(</span><span class='rubyid_tbl_name identifier id'>tbl_name</span><span class='rparen token'>)</span>
      <span class='rubyid_add_table identifier id'>add_table</span><span class='lparen token'>(</span><span class='rubyid_tbl_name identifier id'>tbl_name</span><span class='comma token'>,</span> <span class='rubyid_tbl_schema identifier id'>tbl_schema</span><span class='rparen token'>)</span>
    <span class='rubyid_else else kw'>else</span>
      <span class='rubyid_add_fields identifier id'>add_fields</span><span class='lparen token'>(</span><span class='rubyid_tbl_name identifier id'>tbl_name</span><span class='comma token'>,</span> <span class='rubyid_check_fields_to_add identifier id'>check_fields_to_add</span><span class='lparen token'>(</span><span class='rubyid_tbl_name identifier id'>tbl_name</span><span class='comma token'>,</span> <span class='rubyid_tbl_schema identifier id'>tbl_schema</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rbrace token'>}</span>
  <span class='rubyid_reopen_connection identifier id'>reopen_connection</span>
  <span class='rubyid_self self kw'>self</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on 09/03/14 12:10:56 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.3 (ruby-1.8.7).
</div>

  </body>
</html>
